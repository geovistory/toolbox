{
  "name": "PubAccount",
  "base": "User",
  "idInjection": true,
  "postgresql": {
    "schema": "public",
    "table": "account"
  },
  "mixins": {
    "SetupRemoteMethods": {
      "ignoreACL": false,
      "disableAllExcept": []
    }
  },
  "properties": {
    "id": {
      "type": "number"
    }
  },
  "validations": [],
  "relations": {
    "projects": {
      "type": "hasMany",
      "model": "ComProject",
      "foreignKey": "account_id",
      "keyThrough": "fk_project",
      "through": "PubAccountProjectRel"
    }
  },
  "acls": [
    {
      "accessType": "*",
      "principalType": "ROLE",
      "principalId": "$everyone",
      "permission": "DENY"
    },
    {
      "principalType": "ROLE",
      "principalId": "$everyone",
      "permission": "DENY",
      "property": [
        "confirm"
      ]
    },
    {
      "principalType": "ROLE",
      "principalId": "$everyone",
      "permission": "DENY",
      "accessType": "EXECUTE",
      "property": [
        "verify"
      ]
    },
    {
      "principalType": "ROLE",
      "principalId": "$everyone",
      "permission": "ALLOW",
      "property": [
        "login",
        "logout",
        "create"
      ]
    },
    {
      "principalType": "ROLE",
      "principalId": "$everyone",
      "permission": "ALLOW",
      "accessType": "EXECUTE",
      "property": [
        "resetPassword"
      ]
    },
    {
      "principalType": "ROLE",
      "principalId": "$authenticated",
      "permission": "ALLOW",
      "accessType": "EXECUTE",
      "property": [
        "changePassword",
        "setPassword"
      ]
    },
    {
      "principalType": "ROLE",
      "principalId": "$owner",
      "permission": "DENY",
      "property": [
        "deleteById",
        "patchAttributes",
        "replaceById"
      ]
    },
    {
      "principalType": "ROLE",
      "principalId": "$owner",
      "permission": "ALLOW",
      "property": [
        "findById",
        "listProjects",
        "getRoles"
      ]
    },
    {
      "accessType": "EXECUTE",
      "principalType": "ROLE",
      "principalId": "system_admin",
      "permission": "ALLOW",
      "property": [
        "withRolesAndProjects"
      ]
    }
  ],
  "methods": {
    "getRoles": {
      "accepts": {
        "arg": "id",
        "type": "number",
        "required": true,
        "http": {
          "source": "path"
        }
      },
      "returns": {
        "arg": "roles",
        "type": [
          "Role"
        ],
        "root": true
      },
      "description": "Get Roles of the Account",
      "http": {
        "path": "/:id/get-roles",
        "verb": "get"
      }
    },
    "listProjects": {
      "accepts": {
        "arg": "id",
        "type": "number",
        "required": true,
        "http": {
          "source": "path"
        }
      },
      "returns": {
        "arg": "account",
        "type": [
          "PubAccount"
        ],
        "root": true
      },
      "description": "Get a list of all projects associated with this account.",
      "http": {
        "path": "/:id/list-projects",
        "verb": "get"
      }
    },
    "withRolesAndProjects": {
      "returns": {
        "arg": "accounts",
        "type": [
          "PubAccount"
        ],
        "root": true
      },
      "description": "Get all accounts with their project pks and their roles",
      "http": {
        "path": "/with-roles-and-projects",
        "verb": "get"
      }
    }
  }
}
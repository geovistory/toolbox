!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/common"),require("@angular/core")):"function"==typeof define&&define.amd?define("@kleiolab/lib-utils",["exports","@angular/common","@angular/core"],e):e(((t=t||self).kleiolab=t.kleiolab||{},t.kleiolab["lib-utils"]={}),t.ng.common,t.ng.core)}(this,(function(t,e,n){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function r(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var o=function(){function t(t){this.onDateChange=new n.EventEmitter,Object.assign(this,t)}return Object.defineProperty(t.prototype,"year",{get:function(){return this._year},set:function(t){this._year=t,this.emitDateChange()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"month",{get:function(){return this._month},set:function(t){this._month=t,this.emitDateChange()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"day",{get:function(){return this._day},set:function(t){this._day=t,this.emitDateChange()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hours",{get:function(){return this._hours},set:function(t){this._hours=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minutes",{get:function(){return this._minutes},set:function(t){this._minutes=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"seconds",{get:function(){return this._seconds},set:function(t){this._seconds=t},enumerable:!0,configurable:!0}),t.prototype.calcRunningDay=function(t,e,n){t=null==t?1:t;var i=0;return n&&t>2&&(i=1),(e=null==e?1:e)+30*(t-1)+(i+[-1,0,-2,-1,-1,0,0,1,2,2,3,3][t-1])},t.prototype.calcDateByRunningDay=function(t,e){var n=[-1,0,-2,-1,-1,0,0,1,2,2,3,3],i=Math.floor((t+1)/30)+1,r=n[i-1],o=0;e&&i>2&&(o=1);var s=t-30*(i-1)-(o+r);return(i>12||s<1)&&(--i<1&&(e=!e),o=0,e&&i>2&&(o=1),s=t-30*(i-1)-(o+(r=n[i-1]))),{day:s,month:i}},t.prototype.emitDateChange=function(){this.onDateChange.emit({year:this.year,month:this.month,day:this.day})},t.prototype.getGranularity=function(){var t;return this.year&&(t="1 year"),this.month&&(t="1 month"),this.day&&(t="1 day"),this.hours&&(t="1 hour"),this.minutes&&(t="1 minute"),this.seconds&&(t="1 second"),t},t.prototype.getTimeStamp=function(){var t="";return t=this.year?this.pad(Math.abs(this.year),4):"01",t+="-",t+=this.month?this.pad(this.month,2):"01",t+="-",t+=this.day?this.pad(this.day,2):"01",t+=" ",t+=this.hours?this.pad(this.hours,2):"00",t+=":",t+=this.minutes?this.pad(this.minutes,2):"00",t+=":",t+=this.seconds?this.pad(this.seconds,2):"00",t+=this.year<0?" BC":""},t.prototype.getDate=function(){if(!this.year&&0!==this.year)return null;if(this.day&&!this.month)return null;if(this.hours&&!this.day)return null;if(this.minutes&&!this.hours)return null;if(this.seconds&&!this.hours)return null;var t=new Date;return t.setFullYear(this.year<0?this.year+1:this.year),t.setMonth(this.month?this.month-1:0),t.setDate(this.day?this.day:1),t.setHours(this.hours?this.hours:0),t.setMinutes(this.minutes?this.minutes:0),t.setSeconds(this.seconds?this.seconds:0),t},t.prototype.pad=function(t,e,n){void 0===n&&(n="0");var i=t.toString();return i.length>=e?i:new Array(e-i.length+1).join(n)+i},t.prototype.addYear=function(){this.year++,0===this.year&&this.year++,this.day>this.lengthOfMonth()&&(this.day=this.lengthOfMonth())},t.prototype.addMonth=function(){this.month++,this.month>12?(this.month=1,this.addYear()):this.day>this.lengthOfMonth()&&(this.day=this.lengthOfMonth())},t.prototype.addDay=function(){this.day++,this.day>this.lengthOfMonth()&&(this.day=1,this.addMonth())},t.prototype.addHour=function(){this.hours++,this.hours>23&&(this.hours=0,this.addDay())},t.prototype.addMinute=function(){this.minutes++,this.minutes>59&&(this.minutes=0,this.addHour())},t.prototype.addSecond=function(){this.seconds++,this.seconds>59&&(this.seconds=0,this.addMinute())},t.prototype.removeYear=function(){this.year--,0===this.year&&(this.year=-1),this.day>this.lengthOfMonth()&&(this.day=this.lengthOfMonth())},t.prototype.removeMonth=function(){this.month--,this.month<1?(this.month=12,this.removeYear()):this.day>this.lengthOfMonth()&&(this.day=this.lengthOfMonth())},t.prototype.removeDay=function(){this.day--,this.day<1&&(this.removeMonth(),this.day=this.lengthOfMonth())},t.prototype.removeHour=function(){this.hours--,(this.hours<0||!this.hours)&&(this.hours=23,this.removeDay())},t.prototype.removeMinute=function(){this.minutes--,(this.minutes<0||!this.minutes)&&(this.minutes=59,this.removeHour())},t.prototype.removeSecond=function(){this.seconds--,(this.seconds<0||!this.seconds)&&(this.seconds=59,this.removeMinute())},t.prototype.addDays=function(t){for(var e=0;e<t;e++)this.addDay()},t.prototype.addMonths=function(t){for(var e=0;e<t;e++)this.addMonth()},t.prototype.addYears=function(t){for(var e=0;e<t;e++)this.addYear()},t.prototype.add=function(t){"1 year"===t?this.addYear():"1 month"===t?this.addMonth():"1 day"===t?this.addDay():"1 hour"===t?this.addHour():"1 minute"===t?this.addMinute():"1 second"===t&&this.addSecond()},t.prototype.toLastSecondOf=function(t){this.add(t),this.removeSecond()},t}();var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.getEndOf=function(t){void 0===t&&(t=this.getGranularity());var n=new e(this);return n.toLastSecondOf(t),n},e.prototype.lengthOfMonth=function(){var t=this.year,e=this.month,n=[31,28,31,30,31,30,31,31,30,31,30,31];return t%4||-5==t||-1==t||4==t||(n[1]=29),n[--e]},e.prototype.getJulianDay=function(){var t,e=this.calcRunningDay(this.month,this.day,this.isLeapYear());return t=this.year<0?4716+this.year:4715+this.year,1461*Math.floor(t/4)+365*(t%4-3)+e},e.prototype.fromJulianDay=function(t){"string"==typeof t&&(t=parseInt(t,10));var e=Math.floor((t+1095)/1461),n=(t+1095)%1461,i=Math.floor(n/365),r=n%365;4===i&&(i=3,r=365);var o=4*e+i;this.year=o<=4715?o-4716:o-4715;var s=this.calcDateByRunningDay(r,this.isLeapYear());return this.month=s.month,this.day=s.day,this},e.prototype.isLeapYear=function(){return!(this.year%4)},e.prototype.getJulianSecond=function(){var t=60*this.getJulianDay()*60*24;return this.seconds>0&&(t+=this.seconds),this.minutes>0&&(t+=60*this.minutes),this.hours>0&&(t+=60*this.hours*60),t},e.prototype.fromJulianSecond=function(t){var e=Math.floor(t/86400),n=t%86400;this.hours=Math.floor(n/3600);var i=this.hours%3600;return this.minutes=Math.floor(i/60),this.seconds=this.minutes%60,this.fromJulianDay(e)},e}(o),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.lengthOfMonth=function(){this.year;var t=this.month;if(t>0||t<=12){var e=[31,28,31,30,31,30,31,31,30,31,30,31];return this.isLeapYear()&&(e[1]=29),e[--t]}},e.prototype.getEndOf=function(t){void 0===t&&(t=this.getGranularity());var n=new e(this);return n.toLastSecondOf(t),n},e.prototype.getJulianDay=function(){var t=this.calcRunningDay(this.month,this.day,this.isLeapYear()),e=this.year-1,n=e%400,i=n%100;return 1721426+146097*Math.floor(e/400)+36524*Math.floor(n/100)+1461*Math.floor(i/4)+365*(i%4)+t},e.prototype.fromJulianDay=function(t){"string"==typeof t&&(t=parseInt(t));if(t<2299161){var e=(new s).fromJulianDay(t);this.year=e.year,this.month=e.month,this.day=e.day}else{var n=Math.floor((t-1721426)/146097),i=(t-1721426)%146097,r=Math.floor(i/36524),o=i%36524;4===r&&(r=3,o=36524);var a=Math.floor(o/1461),h=o%1461,u=Math.floor(h/365),c=h%365;4===u&&(u=3,c=365);var y=400*n+100*r+4*a+u;this.year=y+1;var f=this.calcDateByRunningDay(c,this.isLeapYear());this.month=f.month,this.day=f.day}return(this)},e.prototype.isLeapYear=function(){var t=this.year;return!((t%4||!(t%100))&&t%400)},e.prototype.getJulianSecond=function(){var t=60*this.getJulianDay()*60*24;return this.seconds>0&&(t+=this.seconds),this.minutes>0&&(t+=60*this.minutes),this.hours>0&&(t+=60*this.hours*60),t},e.prototype.fromJulianSecond=function(t){var e=Math.floor(t/86400),n=t%86400;this.hours=Math.floor(n/3600);var i=this.hours%3600;return this.minutes=Math.floor(i/60),this.seconds=this.minutes%60,this.fromJulianDay(e)},e}(o);var h=function(){function t(t){this.LAST_DAY_BC=1721422,Object.assign(this,t),t.julian_day&&(this.julianDay=t.julian_day)}return t.prototype.getGregorianDateTime=function(){var t=new a;return t.fromJulianDay(this.julianDay),t},t.prototype.getJulianDateTime=function(){var t=new s;return t.fromJulianDay(this.julianDay),t},t.prototype.getDateTime=function(t){return void 0===t&&(t=this.calendar),t?"gregorian"===t?this.getGregorianDateTime():"julian"===t?this.getJulianDateTime():void 0:null},t.prototype.getDate=function(t){return void 0===t&&(t=this.calendar),this.getDateTime(t).getDate()},t.prototype.getDateFormatString=function(t){if(this.julianDay<=this.LAST_DAY_BC)switch(t){case"1 year":return"y GG";case"1 month":return"MMM, y GG";case"1 day":return"MMM d, y GG";case"1 hour":return"MMM d, y GG, HH";case"1 minute":return"MMM d, y GG, HH:mm";case"1 second":return"MMM d, y GG, HH:mm:ss";default:return""}else switch(t){case"1 year":return"y";case"1 month":return"MMM, y";case"1 day":return"MMM d, y";case"1 hour":return"MMM d, y, HH";case"1 minute":return"MMM d, y, HH:mm";case"1 second":return"MMM d, y, HH:mm:ss";default:return""}},t.prototype.getShortesDateFormatString=function(){return this.getDateFormatString(this.duration)},t.prototype.getJulianSecond=function(){return 60*this.julianDay*60*24},t.prototype.getLastSecond=function(t){return void 0===t&&(t=this.calendar),this.getDateTime().getEndOf(this.duration).getJulianSecond()},t}();var u=function(){function t(t){this.datePipe=t}return t.prototype.transform=function(t){if(!t)return null;var e=new h(t);if(!e)return null;var n=e.getDateTime();if(!n)return null;n.year<0&&(n.year=n.year+1),n.day||(n.day=31);var i=n.getDate();return this.datePipe.transform(i,e.getShortesDateFormatString())},t.decorators=[{type:n.Pipe,args:[{name:"timePrimitive"}]}],t.ctorParameters=function(){return[{type:e.DatePipe}]},t}();var c=function(){function t(t){var e=this;this.tpKeys=["p82","p81","p82a","p82b","p81a","p81b"],t&&(Object.keys(t).forEach((function(e){return void 0===t[e]?delete t[e]:""})),Object.assign(this,t),this.tpKeys.forEach((function(t){e[t]&&(e[t]=new h(e[t]))})))}return Object.defineProperty(t.prototype,"earliestDay",{get:function(){var t=this;if(this.isEmpty())return null;var e=Number.POSITIVE_INFINITY;return this.tpKeys.forEach((function(n){if(t[n]){var i=t[n].julianDay;e=i<e?i:e}})),e},enumerable:!0,configurable:!0}),t.getMinMaxTimePrimitveOfArray=function(t){if(!t||t.length<1)return null;var e=t[0],n=t[0];return t.forEach((function(t){e=t.getJulianSecond()<e.getJulianSecond()?t:e,n=t.getJulianSecond()>n.getJulianSecond()?t:n})),{min:e,max:n}},t.fromTimeSpanDialogData=function(e){void 0===e&&(e={}),e||(e={});var n={};return e[72]&&(n.p82=e[72]),e[71]&&(n.p81=e[71]),e[152]&&(n.p82a=e[152]),e[150]&&(n.p81a=e[150]),e[151]&&(n.p81b=e[151]),e[153]&&(n.p82b=e[153]),new t(n)},t.prototype.isEmpty=function(){return!this.isNotEmpty()},t.prototype.isNotEmpty=function(){return!!(this.p82||this.p81||this.p82a||this.p82b||this.p81a||this.p81b)},t.prototype.getMinMaxTimePrimitive=function(){return t.getMinMaxTimePrimitveOfArray(this.getArrayOfTimePrimitives())},t.prototype.getArrayOfTimePrimitives=function(){var t=this,e=[];return this.tpKeys.forEach((function(n){t[n]&&e.push(t[n])})),e},t.prototype.getPrimitivesForPreview=function(){return{single:this.p82||this.p81,begin:this.p82a||this.p81a,end:this.p82b||this.p81b}},t}();var y=function(){function t(t){this.timePrimitivePipe=t}return t.prototype.transform=function(t){if(!t)return null;var e=new c(t).getPrimitivesForPreview();return e.single||e.begin||e.end?!e.single||e.begin||e.end?e.begin&&e.end&&!e.single?this.getString(e.begin)+" – "+this.getString(e.end):e.single&&e.end&&!e.begin?this.getString(e.single)+" – "+this.getString(e.end):e.begin&&e.single&&!e.end?this.getString(e.begin)+" – "+this.getString(e.single):this.getString(e.begin)+" – "+this.getString(e.end):this.getString(e.single):""},t.prototype.getString=function(t){var e=this.timePrimitivePipe.transform(t);return e||"(?)"},t.decorators=[{type:n.Pipe,args:[{name:"timeSpan"}]}],t.ctorParameters=function(){return[{type:u}]},t}();var f=function(){function t(){}return t.decorators=[{type:n.NgModule,args:[{imports:[e.CommonModule],providers:[u,y],declarations:[y,u],exports:[y,u]}]}],t}();var p=function(){function t(){}return t.obj2Arr=function(t){var e=[];return null==t?e:(Object.keys(t).forEach((function(n){e.push(t[n])})),e)},t.objNr2Arr=function(t){var e=[];return null==t?e:(Object.keys(t).forEach((function(n){e.push(t[n])})),e)},t.obj2KeyValueArr=function(t){var e=[];for(var n in t)t[n]&&e.push({key:n,value:t[n]});return e},t.firstProTextPropStringOfType=function(t,e){return(t.find((function(t){return t.fk_system_type===e}))||{string:""}).string},t.uuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"===t?e:e%4+8).toString(16)}))},t.propertyFieldKeyFromParams=function(t,e){return"_"+t+"_"+(e?"outgoing":"ingoing")},t.toStr0undef=function(t){return 0===t?void 0:void 0===t?void 0:null===t?void 0:t.toString()},t.toStrContains0undef=function(t){for(var e="",n=0;n<t.length;n++){var i=t[n];if(0===i)return;if(void 0===i)return;if(null===i)return;e=0===n?i.toString():e+"_"+i.toString()}return e},t.recursiveMarkAsTouched=function(e){if(e.controls)if(Array.isArray(e.controls))e.controls.forEach((function(e){e.markAsTouched(),e.controls&&t.recursiveMarkAsTouched(e)}));else if(e.controls.childControl){var n=e.controls.childControl;n.markAsTouched(),n.controls&&t.recursiveMarkAsTouched(n)}},t}();t.DateTimeCommons=o,t.DateTimeModule=f,t.GregorianDateTime=a,t.JulianDateTime=s,t.TimePrimitive=h,t.TimePrimitivePipe=u,t.TimeSpanPipe=y,t.TimeSpanUtil=c,t.U=p,t.x=void 0,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=kleiolab-lib-utils.umd.min.js.map
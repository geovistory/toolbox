!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/common"),require("@angular/core")):"function"==typeof define&&define.amd?define("@kleiolab/lib-utils/src/lib/date-time",["exports","@angular/common","@angular/core"],e):e(((t=t||self).kleiolab=t.kleiolab||{},t.kleiolab["lib-utils"]=t.kleiolab["lib-utils"]||{},t.kleiolab["lib-utils"].src=t.kleiolab["lib-utils"].src||{},t.kleiolab["lib-utils"].src.lib=t.kleiolab["lib-utils"].src.lib||{},t.kleiolab["lib-utils"].src.lib["date-time"]={}),t.ng.common,t.ng.core)}(this,(function(t,e,i){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};function r(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var o=function(){function t(t){this.onDateChange=new i.EventEmitter,Object.assign(this,t)}return Object.defineProperty(t.prototype,"year",{get:function(){return this._year},set:function(t){this._year=t,this.emitDateChange()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"month",{get:function(){return this._month},set:function(t){this._month=t,this.emitDateChange()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"day",{get:function(){return this._day},set:function(t){this._day=t,this.emitDateChange()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hours",{get:function(){return this._hours},set:function(t){this._hours=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minutes",{get:function(){return this._minutes},set:function(t){this._minutes=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"seconds",{get:function(){return this._seconds},set:function(t){this._seconds=t},enumerable:!0,configurable:!0}),t.prototype.calcRunningDay=function(t,e,i){t=null==t?1:t;var n=0;return i&&t>2&&(n=1),(e=null==e?1:e)+30*(t-1)+(n+[-1,0,-2,-1,-1,0,0,1,2,2,3,3][t-1])},t.prototype.calcDateByRunningDay=function(t,e){var i=[-1,0,-2,-1,-1,0,0,1,2,2,3,3],n=Math.floor((t+1)/30)+1,r=i[n-1],o=0;e&&n>2&&(o=1);var s=t-30*(n-1)-(o+r);return(n>12||s<1)&&(--n<1&&(e=!e),o=0,e&&n>2&&(o=1),s=t-30*(n-1)-(o+(r=i[n-1]))),{day:s,month:n}},t.prototype.emitDateChange=function(){this.onDateChange.emit({year:this.year,month:this.month,day:this.day})},t.prototype.getGranularity=function(){var t;return this.year&&(t="1 year"),this.month&&(t="1 month"),this.day&&(t="1 day"),this.hours&&(t="1 hour"),this.minutes&&(t="1 minute"),this.seconds&&(t="1 second"),t},t.prototype.getTimeStamp=function(){var t="";return t=this.year?this.pad(Math.abs(this.year),4):"01",t+="-",t+=this.month?this.pad(this.month,2):"01",t+="-",t+=this.day?this.pad(this.day,2):"01",t+=" ",t+=this.hours?this.pad(this.hours,2):"00",t+=":",t+=this.minutes?this.pad(this.minutes,2):"00",t+=":",t+=this.seconds?this.pad(this.seconds,2):"00",t+=this.year<0?" BC":""},t.prototype.getDate=function(){if(!this.year&&0!==this.year)return null;if(this.day&&!this.month)return null;if(this.hours&&!this.day)return null;if(this.minutes&&!this.hours)return null;if(this.seconds&&!this.hours)return null;var t=new Date;return t.setFullYear(this.year<0?this.year+1:this.year),t.setMonth(this.month?this.month-1:0),t.setDate(this.day?this.day:1),t.setHours(this.hours?this.hours:0),t.setMinutes(this.minutes?this.minutes:0),t.setSeconds(this.seconds?this.seconds:0),t},t.prototype.pad=function(t,e,i){void 0===i&&(i="0");var n=t.toString();return n.length>=e?n:new Array(e-n.length+1).join(i)+n},t.prototype.addYear=function(){this.year++,0===this.year&&this.year++,this.day>this.lengthOfMonth()&&(this.day=this.lengthOfMonth())},t.prototype.addMonth=function(){this.month++,this.month>12?(this.month=1,this.addYear()):this.day>this.lengthOfMonth()&&(this.day=this.lengthOfMonth())},t.prototype.addDay=function(){this.day++,this.day>this.lengthOfMonth()&&(this.day=1,this.addMonth())},t.prototype.addHour=function(){this.hours++,this.hours>23&&(this.hours=0,this.addDay())},t.prototype.addMinute=function(){this.minutes++,this.minutes>59&&(this.minutes=0,this.addHour())},t.prototype.addSecond=function(){this.seconds++,this.seconds>59&&(this.seconds=0,this.addMinute())},t.prototype.removeYear=function(){this.year--,0===this.year&&(this.year=-1),this.day>this.lengthOfMonth()&&(this.day=this.lengthOfMonth())},t.prototype.removeMonth=function(){this.month--,this.month<1?(this.month=12,this.removeYear()):this.day>this.lengthOfMonth()&&(this.day=this.lengthOfMonth())},t.prototype.removeDay=function(){this.day--,this.day<1&&(this.removeMonth(),this.day=this.lengthOfMonth())},t.prototype.removeHour=function(){this.hours--,(this.hours<0||!this.hours)&&(this.hours=23,this.removeDay())},t.prototype.removeMinute=function(){this.minutes--,(this.minutes<0||!this.minutes)&&(this.minutes=59,this.removeHour())},t.prototype.removeSecond=function(){this.seconds--,(this.seconds<0||!this.seconds)&&(this.seconds=59,this.removeMinute())},t.prototype.addDays=function(t){for(var e=0;e<t;e++)this.addDay()},t.prototype.addMonths=function(t){for(var e=0;e<t;e++)this.addMonth()},t.prototype.addYears=function(t){for(var e=0;e<t;e++)this.addYear()},t.prototype.add=function(t){"1 year"===t?this.addYear():"1 month"===t?this.addMonth():"1 day"===t?this.addDay():"1 hour"===t?this.addHour():"1 minute"===t?this.addMinute():"1 second"===t&&this.addSecond()},t.prototype.toLastSecondOf=function(t){this.add(t),this.removeSecond()},t}();var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.getEndOf=function(t){void 0===t&&(t=this.getGranularity());var i=new e(this);return i.toLastSecondOf(t),i},e.prototype.lengthOfMonth=function(){var t=this.year,e=this.month,i=[31,28,31,30,31,30,31,31,30,31,30,31];return t%4||-5==t||-1==t||4==t||(i[1]=29),i[--e]},e.prototype.getJulianDay=function(){var t,e=this.calcRunningDay(this.month,this.day,this.isLeapYear());return t=this.year<0?4716+this.year:4715+this.year,1461*Math.floor(t/4)+365*(t%4-3)+e},e.prototype.fromJulianDay=function(t){"string"==typeof t&&(t=parseInt(t,10));var e=Math.floor((t+1095)/1461),i=(t+1095)%1461,n=Math.floor(i/365),r=i%365;4===n&&(n=3,r=365);var o=4*e+n;this.year=o<=4715?o-4716:o-4715;var s=this.calcDateByRunningDay(r,this.isLeapYear());return this.month=s.month,this.day=s.day,this},e.prototype.isLeapYear=function(){return!(this.year%4)},e.prototype.getJulianSecond=function(){var t=60*this.getJulianDay()*60*24;return this.seconds>0&&(t+=this.seconds),this.minutes>0&&(t+=60*this.minutes),this.hours>0&&(t+=60*this.hours*60),t},e.prototype.fromJulianSecond=function(t){var e=Math.floor(t/86400),i=t%86400;this.hours=Math.floor(i/3600);var n=this.hours%3600;return this.minutes=Math.floor(n/60),this.seconds=this.minutes%60,this.fromJulianDay(e)},e}(o),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.lengthOfMonth=function(){this.year;var t=this.month;if(t>0||t<=12){var e=[31,28,31,30,31,30,31,31,30,31,30,31];return this.isLeapYear()&&(e[1]=29),e[--t]}},e.prototype.getEndOf=function(t){void 0===t&&(t=this.getGranularity());var i=new e(this);return i.toLastSecondOf(t),i},e.prototype.getJulianDay=function(){var t=this.calcRunningDay(this.month,this.day,this.isLeapYear()),e=this.year-1,i=e%400,n=i%100;return 1721426+146097*Math.floor(e/400)+36524*Math.floor(i/100)+1461*Math.floor(n/4)+365*(n%4)+t},e.prototype.fromJulianDay=function(t){"string"==typeof t&&(t=parseInt(t));if(t<2299161){var e=(new s).fromJulianDay(t);this.year=e.year,this.month=e.month,this.day=e.day}else{var i=Math.floor((t-1721426)/146097),n=(t-1721426)%146097,r=Math.floor(n/36524),o=n%36524;4===r&&(r=3,o=36524);var a=Math.floor(o/1461),h=o%1461,u=Math.floor(h/365),y=h%365;4===u&&(u=3,y=365);var c=400*i+100*r+4*a+u;this.year=c+1;var p=this.calcDateByRunningDay(y,this.isLeapYear());this.month=p.month,this.day=p.day}return(this)},e.prototype.isLeapYear=function(){var t=this.year;return!((t%4||!(t%100))&&t%400)},e.prototype.getJulianSecond=function(){var t=60*this.getJulianDay()*60*24;return this.seconds>0&&(t+=this.seconds),this.minutes>0&&(t+=60*this.minutes),this.hours>0&&(t+=60*this.hours*60),t},e.prototype.fromJulianSecond=function(t){var e=Math.floor(t/86400),i=t%86400;this.hours=Math.floor(i/3600);var n=this.hours%3600;return this.minutes=Math.floor(n/60),this.seconds=this.minutes%60,this.fromJulianDay(e)},e}(o);var h=function(){function t(t){this.LAST_DAY_BC=1721422,Object.assign(this,t),t.julian_day&&(this.julianDay=t.julian_day)}return t.prototype.getGregorianDateTime=function(){var t=new a;return t.fromJulianDay(this.julianDay),t},t.prototype.getJulianDateTime=function(){var t=new s;return t.fromJulianDay(this.julianDay),t},t.prototype.getDateTime=function(t){return void 0===t&&(t=this.calendar),t?"gregorian"===t?this.getGregorianDateTime():"julian"===t?this.getJulianDateTime():void 0:null},t.prototype.getDate=function(t){return void 0===t&&(t=this.calendar),this.getDateTime(t).getDate()},t.prototype.getDateFormatString=function(t){if(this.julianDay<=this.LAST_DAY_BC)switch(t){case"1 year":return"y GG";case"1 month":return"MMM, y GG";case"1 day":return"MMM d, y GG";case"1 hour":return"MMM d, y GG, HH";case"1 minute":return"MMM d, y GG, HH:mm";case"1 second":return"MMM d, y GG, HH:mm:ss";default:return""}else switch(t){case"1 year":return"y";case"1 month":return"MMM, y";case"1 day":return"MMM d, y";case"1 hour":return"MMM d, y, HH";case"1 minute":return"MMM d, y, HH:mm";case"1 second":return"MMM d, y, HH:mm:ss";default:return""}},t.prototype.getShortesDateFormatString=function(){return this.getDateFormatString(this.duration)},t.prototype.getJulianSecond=function(){return 60*this.julianDay*60*24},t.prototype.getLastSecond=function(t){return void 0===t&&(t=this.calendar),this.getDateTime().getEndOf(this.duration).getJulianSecond()},t}();var u=function(){function t(t){this.datePipe=t}return t.prototype.transform=function(t){if(!t)return null;var e=new h(t);if(!e)return null;var i=e.getDateTime();if(!i)return null;i.year<0&&(i.year=i.year+1),i.day||(i.day=31);var n=i.getDate();return this.datePipe.transform(n,e.getShortesDateFormatString())},t.decorators=[{type:i.Pipe,args:[{name:"timePrimitive"}]}],t.ctorParameters=function(){return[{type:e.DatePipe}]},t}();var y=function(){function t(t){var e=this;this.tpKeys=["p82","p81","p82a","p82b","p81a","p81b"],t&&(Object.keys(t).forEach((function(e){return void 0===t[e]?delete t[e]:""})),Object.assign(this,t),this.tpKeys.forEach((function(t){e[t]&&(e[t]=new h(e[t]))})))}return Object.defineProperty(t.prototype,"earliestDay",{get:function(){var t=this;if(this.isEmpty())return null;var e=Number.POSITIVE_INFINITY;return this.tpKeys.forEach((function(i){if(t[i]){var n=t[i].julianDay;e=n<e?n:e}})),e},enumerable:!0,configurable:!0}),t.getMinMaxTimePrimitveOfArray=function(t){if(!t||t.length<1)return null;var e=t[0],i=t[0];return t.forEach((function(t){e=t.getJulianSecond()<e.getJulianSecond()?t:e,i=t.getJulianSecond()>i.getJulianSecond()?t:i})),{min:e,max:i}},t.fromTimeSpanDialogData=function(e){void 0===e&&(e={}),e||(e={});var i={};return e[72]&&(i.p82=e[72]),e[71]&&(i.p81=e[71]),e[152]&&(i.p82a=e[152]),e[150]&&(i.p81a=e[150]),e[151]&&(i.p81b=e[151]),e[153]&&(i.p82b=e[153]),new t(i)},t.prototype.isEmpty=function(){return!this.isNotEmpty()},t.prototype.isNotEmpty=function(){return!!(this.p82||this.p81||this.p82a||this.p82b||this.p81a||this.p81b)},t.prototype.getMinMaxTimePrimitive=function(){return t.getMinMaxTimePrimitveOfArray(this.getArrayOfTimePrimitives())},t.prototype.getArrayOfTimePrimitives=function(){var t=this,e=[];return this.tpKeys.forEach((function(i){t[i]&&e.push(t[i])})),e},t.prototype.getPrimitivesForPreview=function(){return{single:this.p82||this.p81,begin:this.p82a||this.p81a,end:this.p82b||this.p81b}},t}();var c=function(){function t(t){this.timePrimitivePipe=t}return t.prototype.transform=function(t){if(!t)return null;var e=new y(t).getPrimitivesForPreview();return e.single||e.begin||e.end?!e.single||e.begin||e.end?e.begin&&e.end&&!e.single?this.getString(e.begin)+" – "+this.getString(e.end):e.single&&e.end&&!e.begin?this.getString(e.single)+" – "+this.getString(e.end):e.begin&&e.single&&!e.end?this.getString(e.begin)+" – "+this.getString(e.single):this.getString(e.begin)+" – "+this.getString(e.end):this.getString(e.single):""},t.prototype.getString=function(t){var e=this.timePrimitivePipe.transform(t);return e||"(?)"},t.decorators=[{type:i.Pipe,args:[{name:"timeSpan"}]}],t.ctorParameters=function(){return[{type:u}]},t}();var p=function(){function t(){}return t.decorators=[{type:i.NgModule,args:[{imports:[e.CommonModule],providers:[u,c],declarations:[c,u],exports:[c,u]}]}],t}();t.DateTimeCommons=o,t.DateTimeModule=p,t.GregorianDateTime=a,t.JulianDateTime=s,t.TimePrimitive=h,t.TimePrimitivePipe=u,t.TimeSpanPipe=c,t.TimeSpanUtil=y,t.x=void 0,t.ɵa=u,t.ɵb=c,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=kleiolab-lib-utils-src-lib-date-time.umd.min.js.map
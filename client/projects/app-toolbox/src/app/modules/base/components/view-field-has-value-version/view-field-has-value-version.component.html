<div *ngIf="(quillDocLoader$|async).loading" class="loc-loading-spinner">
  <mat-spinner [diameter]="20"></mat-spinner>
</div>
<div *ngIf="(quillDocLoader$|async).error" class="loc-loading-error mat-body">
  <p>Error when loading the text</p>
  <button mat-button (click)="loadTrigger$.next()">try again</button>
</div>
<gv-quill-edit [hidden]="showHistory$|async" *ngIf="!(quillDocLoader$|async).loading && !(quillDocLoader$|async).error"
  class="gv-flex-fh gv-quill-borderless" [quillDoc]="(quillDocLoader$|async).quillDoc"
  (quillDocChange)="newQuillDoc=$event" [readOnly]="!(editing$|async)">
  <ng-container buttonsRight>
    <button mat-icon-button *ngIf="(editing$|async)" (click)="save();editing$.next(false)">
      <mat-icon>save</mat-icon>
    </button>
    <button mat-icon-button *ngIf="(editing$|async)" (click)="loadTrigger$.next();editing$.next(false)">
      <mat-icon>cancel</mat-icon>
    </button>
    <button mat-icon-button *ngIf="!(editing$|async)" (click)="editing$.next(true)">
      <mat-icon>edit</mat-icon>
    </button>
    <button mat-icon-button *ngIf="!(editing$|async)" (click)="showHistory$.next(true)">
      <mat-icon>history</mat-icon>
    </button>

  </ng-container>
</gv-quill-edit>

<div class="gv-flex-fh" *ngIf="showHistory$|async">

  <!-- header -->
  <div class="loc-header mat-bg-grey-50">
    <button mat-icon-button (click)="showHistory$.next(false); loadTrigger$.next()">
      <mat-icon>back</mat-icon> Back to current version
    </button>
  </div>

  <!-- body -->
  <div class="loc-body">

    <div class="loc-header mat-bg-grey-100">
      Your current version
    </div>

    <gv-view-field-body [showBodyOnInit]=true [field]="field" [scope]="scope" [showOntoInfo$]="showOntoInfo$"
      [readonly$]="readonly$" [source]="source"></gv-view-field-body>


    <div class="loc-header mat-bg-grey-100">
      All versions
    </div>
    <gv-view-field-body [showBodyOnInit]=true [field]="field" [scope]="{noContraint:true}"
      [showOntoInfo$]="showOntoInfo$" [readonly$]="readonly$" [source]="source">
    </gv-view-field-body>


  </div>

</div>

<as-split class="gv-split-style" [direction]="'horizontal'" gutterSize="1">


  <!-------------------------------------------------------------------
     Query Definition 
  -------------------------------------------------------------------->
  <as-split-area [size]="((showRightArea$ | async) ? 50 : 100)" class="d-flex flex-column">

    <gv-detail-top-bar>
      Query
      <button class="ml-auto btn btn-sm btn-primary" (click)="onRun()">Run >></button>
    </gv-detail-top-bar>
   

    <mat-vertical-stepper [linear]="false" #stepper>
      <mat-step [stepControl]="firstFormGroup">
        <form [formGroup]="firstFormGroup">
          <ng-template matStepLabel>Define a filter for the resulting rows</ng-template>

          <gv-class-and-type-filter [pkClasses$]="p.classesInProject$" [showRemoveBtn]="false" [formControl]="filterCtrl">
          </gv-class-and-type-filter>

          <!-- <div>
            <button mat-flat-button color="primary" matStepperNext>Next</button>
          </div> -->
        </form>
      </mat-step>
      <mat-step [stepControl]="secondFormGroup">
        <form [formGroup]="secondFormGroup">
          <ng-template matStepLabel>Define the resulting columns</ng-template>
          <!-- <mat-form-field appearance="outline">
            <input matInput placeholder="Address" formControlName="secondCtrl" required>
          </mat-form-field> -->
          <div class="my-3">
            <gv-col-def-editor [propertyOptions$]="propertyOptions$" [formControl]="columnsCtrl"></gv-col-def-editor>
          </div>
          <div>
            <button mat-flat-button matStepperPrevious>Back</button>
            <button mat-flat-button matStepperNext>Next</button>
          </div>
          <!-- {{colDefs |Â json}}  -->
        </form>
      </mat-step>
      <mat-step [stepControl]="thirdFormGroup">
        <form [formGroup]="thirdFormGroup">
          <ng-template matStepLabel>Save</ng-template>
          <p>Give your query a name and description.</p>
          <p>
            <mat-form-field>
              <input matInput placeholder="Name" formControlName="nameCtrl" required>
              <mat-hint>Name of the query.</mat-hint>
            </mat-form-field>
          </p>
          <p>
            <mat-form-field>
              <textarea matInput placeholder="Description" formControlName="descriptionCtrl"></textarea>
              <mat-hint>Description of the query.</mat-hint>
            </mat-form-field>
          </p>
          <div>
            <button mat-flat-button type="button" matStepperPrevious>Back</button>
            <button mat-flat-button type="submit" (click)="onSave()">Save</button>
          </div>
        </form>
      </mat-step>
    </mat-vertical-stepper>

  </as-split-area>

  <!-------------------------------------------------------------------
    Query Results 
  -------------------------------------------------------------------->
  <as-split-area *ngIf="(showRightArea$ | async)" [size]="50" class="d-flex flex-column">

    <gv-detail-top-bar>
      {{fullCount$ | async}} Results

      <button class="ml-auto btn btn-sm btn-link-gray" (click)="hideRightArea()"><i class="fa fa-close"></i></button>
    </gv-detail-top-bar>

      <gv-result-table class="gv-flex-fh"
      [data$]="queryResults$"
      [pending$]="pending$"
      [colDef]="colDefsCopy"
      [columns]="displayedColumns"
      [limit]="limit"
      (rangeChange)="onScroll($event)"
      ></gv-result-table>


  </as-split-area>
</as-split>
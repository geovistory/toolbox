<!-- <h3>Class Fields</h3>

<p>
  Class fields define what properties entities of a specific class can have and how those fields are
  configured.
</p>
<br> -->
<h3>General fields</h3>
<p class="mat-caption">General fields are available for all classes and can't be enabled/disabled.</p>

<p-table [value]="defaultFields$|async" class="mat-table w-100">
  <ng-template pTemplate="header">
    <tr class="mat-header-row">
      <th class="mat-header-cell">OntoMe</th>
      <th class="mat-header-cell">Display Label</th>
      <th class="mat-header-cell">Relates to class(es)</th>
      <th class="mat-header-cell">Enabled</th>
      <th class="mat-header-cell"></th>
    </tr>
  </ng-template>
  <ng-template pTemplate="body" let-row>
    <tr class="mat-row">
      <td>
        <gv-onto-property-info *ngIf="row.propertyField" [pkProperty]="row.pkProperty"></gv-onto-property-info>
      </td>
      <td class="mat-cell mat-body-strong">{{row.label}}</td>
      <td class="mat-cell">
        <span *ngIf="row?.propertyField?.targetClasses; let truncated" class="mat-text-secondary">
          <span>
            <span *ngFor="let item of row.propertyField.targetClasses | slice:0:3; let i = index">
              <span *ngIf="i>0">,</span>
              {{item.label}}
            </span>
            <span *ngIf="row.propertyField.targetClasses.length > 3">
              , + {{row.propertyField.targetClasses.length-3}}
            </span>
          </span>
        </span>
      </td>
      <td class="mat-cell">
        <mat-checkbox [disabled]="true" [checked]="true"></mat-checkbox>
      </td>
      <td class="mat-cell"><button mat-flat-button color="primary" *ngIf="row.propertyField"
          (click)="openFieldDialog(row)">Edit Labels</button></td>
    </tr>
  </ng-template>
</p-table>


<br>
<br>
<h3>Specific fields</h3>
<p class="mat-caption">Specific fields are specific for this class and correspond to properties on OntoMe.
  Disable fields you don't need, reorder fields (drag&drop) or rename their labels according to your
  needs.</p>



<p-table [value]="specificFields$|async" class="mat-table w-100" (onRowReorder)="onRowReorder($event)">
  <ng-template pTemplate="header">
    <tr class="mat-header-row">
      <th class="mat-header-cell drag-col"></th>
      <th class="mat-header-cell">OntoMe</th>
      <th class="mat-header-cell">Display Label</th>
      <th class="mat-header-cell">Relates to class(es)</th>
      <th class="mat-header-cell">Enabled</th>
      <th class="mat-header-cell"></th>
    </tr>
  </ng-template>
  <ng-template pTemplate="body" let-row let-index="rowIndex">
    <tr class="mat-row" [pReorderableRow]="index">
      <td class="mat-cell drag-col">
        <!-- <mat-icon svgIcon="bars"></mat-icon> -->
        <i *ngIf="!reordering" class="fa fa-bars gv-cursor-drag" pReorderableRowHandle>
        </i>
        <mat-spinner *ngIf="reordering" diameter="20" color="accent"></mat-spinner>
      </td>
      <td>
        <gv-onto-property-info *ngIf="row.propertyField" [pkProperty]="row.pkProperty"></gv-onto-property-info>
      </td>
      <td class="mat-cell mat-body-strong">{{row.label}}</td>
      <td class="mat-cell">
        <span *ngIf="row?.propertyField?.targetClasses; let truncated" class="mat-text-secondary">
          <span>
            <span *ngFor="let item of row.propertyField.targetClasses | slice:0:3; let i = index">
              <span *ngIf="i>0">,</span>
              {{item.label}}
            </span>
            <span *ngIf="row.propertyField.targetClasses.length > 3">
              , + {{row.propertyField.targetClasses.length-3}}
            </span>
          </span>
        </span>
      </td>
      <td class="mat-cell">
        <mat-checkbox [checked]="true"></mat-checkbox>
      </td>
      <td class="mat-cell"><button mat-flat-button color="primary" *ngIf="row.propertyField"
          (click)="openFieldDialog(row)">Edit Labels</button>
      </td>
    </tr>
  </ng-template>
</p-table>

<!-- <table class="mat-table">

  <tr class="mat-header-row">
    <th class="mat-header-cell">Display Label</th>
    <th class="mat-header-cell">Relates to class(es)</th>
    <th class="mat-header-cell">Enabled</th>
    <th class="mat-header-cell"></th>
  </tr>
  <tr class="mat-row">
    <td class="mat-cell mat-body-strong">Naming</td>
    <td class="mat-cell">Appellation for Language</td>
    <td class="mat-cell">
      <mat-checkbox [checked]="true"></mat-checkbox>
    </td>
    <td class="mat-cell">Edit Labels</td>
  </tr>
  <tr class="mat-row">
    <td class="mat-cell mat-body-strong">Type</td>
    <td class="mat-cell"></td>
    <td class="mat-cell">
      <mat-checkbox [checked]="true"></mat-checkbox>
    </td>
    <td class="mat-cell">Edit Labels</td>

  </tr>
  <tr class="mat-row">
    <td class="mat-cell mat-body-strong">Definition</td>
    <td class="mat-cell"></td>
    <td class="mat-cell">
      <mat-checkbox [checked]="true"></mat-checkbox>
    </td>
    <td class="mat-cell">Edit Labels</td>

  </tr>

  <tr class="mat-row">
    <td class="mat-cell mat-body-strong">Time Span</td>
    <td class="mat-cell"></td>
    <td class="mat-cell">
      <mat-checkbox [checked]="true"></mat-checkbox>
    </td>
    <td class="mat-cell">Edit Labels</td>
  </tr>

</table> -->


<!-- <mat-accordion displayMode="flat" multi="true">
  <mat-expansion-panel expanded="false" *ngFor="let field of (fields$ | async ); trackBy:getKey">
    <mat-expansion-panel-header>
      <mat-panel-title>
        <strong>
          {{field.label}} {{field?.propertyField?.isIdentityDefining ? '*' : ''}}
        </strong>
        <span *ngIf="field?.propertyField?.targetClasses; let truncated" class="mat-text-secondary ml-2">
          <span>
            [
            <span *ngFor="let item of field.propertyField.targetClasses | slice:0:3; let i = index">
              <span *ngIf="i>0">,</span>
              {{item.label}}
            </span>
            <span *ngIf="field.propertyField.targetClasses.length > 3">
              , + {{field.propertyField.targetClasses.length-3}}

            </span>
            ]
          </span>

        </span>
      </mat-panel-title>

    </mat-expansion-panel-header>

    <div *ngIf="field.propertyField">
      <ng-container *ngTemplateOutlet="propertyField; context:{field: field, classLabel$: classLabel$}"></ng-container>
    </div>

    <div *ngIf="!field.propertyField">
      <ng-container *ngTemplateOutlet="classField; context:{field: field}"></ng-container>
    </div>

  </mat-expansion-panel>
</mat-accordion>


<ng-template #propertyField let-field="field" let-classLabel$="classLabel$">

  <p class="mb-3">
    OntoInfo: <a href="{{field.ontoInfoUrl}}" target="_blank"> {{field.ontoInfoLabel}} </a>.
  </p>
  <div class="mat-body-2">
    Labels
  </div>
  <div class="mat-caption mb-1">
    Define the label of this field:
  </div>
  <mat-divider></mat-divider>

  <gv-property-label-table [fkProperty]="field.propertyField.labelTable.fkProperty"
    [fkPropertyDomain]="field.propertyField.labelTable.fkDomainClass"
    [fkPropertyRange]="field.propertyField.labelTable.fkRangeClass" [fkSystemType]="labelSysType">
  </gv-property-label-table>

  <div class="mat-body-2 mt-3">
    Related Classes
  </div>
  <div class="mat-caption mb-1">
    The field relates entities of the following classes to {{classLabel$ | async}}:
  </div>
  <mat-divider></mat-divider>

  <table mat-table [dataSource]="field.propertyField.classTable.rows" class="mat-elevation-z0 w-100">

    <ng-container matColumnDef="label">
      <th mat-header-cell *matHeaderCellDef> Classes </th>
      <td mat-cell *matCellDef="let element"> {{element.label}} </td>
    </ng-container>

    <ng-container matColumnDef="actions">
      <th mat-header-cell *matHeaderCellDef>
        <button mat-icon-button>
          <mat-icon>add</mat-icon>
        </button>
      </th>
      <td mat-cell *matCellDef="let element">
        <button mat-icon-button>
          <mat-icon>delete</mat-icon>
        </button>
        <button mat-icon-button>
          <mat-icon>edit</mat-icon>
        </button>
      </td>
    </ng-container>
    <tr mat-header-row *matHeaderRowDef="field.propertyField.classTable.displayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: field.propertyField.classTable.displayedColumns;"></tr>
  </table>

</ng-template>

<ng-template #classField let-field="field">



  <p class="mb-3">
    This field does not corresponds to a property directly.
  </p>

</ng-template> -->

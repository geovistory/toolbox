<!-- <div class="btn-group d-flex flex-row gv-h5">
  <button class="btn btn-light btn-sm btn-block text-left rounded-0">
    <i class="fa fa-caret-right fa-rotate-90"></i>
    When
  </button>
  <div class="gv-flex-grow-1 gv-card-spacer-x align-self-stretch d-flex" *ngIf="(ontoInfoVisible$|async)">
    <div class="align-self-center">
      <a class="badge badge-success" href="http://ontologies.dataforhistory.org/class/50" target="_blank">
        E52
      </a>
    </div>
  </div>
</div> -->


<!-- Navigate to help and back -->
<div class="modal-body d-flex justify-content-end">
  <button class="btn btn-link" *ngIf="(mode$ | async) !== 'advanced'" (click)="showAdvancedMode()">Advanced mode</button>
  <button class="btn btn-link" *ngIf="!(helpVisible$ | async) && (mode$ | async) === 'advanced'" (click)="showHelp()">Help</button>
  <button class="btn btn-link" *ngIf="(helpVisible$ | async)" (click)="hideHelp()">Back</button>
</div>


<div class="modal-body" *ngIf="(helpVisible$ | async)">
  <gv-existence-time-help></gv-existence-time-help>
</div>

<!-- Main content -->
<div *ngIf="!(helpVisible$ | async)">


  <form [formGroup]="formGroup">


    <!-- At some time within -->
    <div class="border-bottom" *ngIf="(mode$ | async) !== 'begin-end'">

      <button class="btn btn-link" type="button" *ngIf="!((_roleSet_list$ | async)?._72_outgoing)" (click)="addRoleSet(72)">+ At some time within</button>

      <div class="modal-body" *ngIf="((_roleSet_list$ | async)?._72_outgoing) && formGroup.get('_72_outgoing')">

        <ng-container *ngTemplateOutlet="header; context:{key:'_72_outgoing', label: 'At some time within'}"></ng-container>
          <!-- <span *ngIf="(mode$ | async) !== 'one-date'">
        </span> -->

        <gv-ex-time-role-set-create-ctrl [parentPath]="basePath" [parentTeEntStatePath]="parentTeEntPath" formControlName="_72_outgoing"
          [index]="'_72_outgoing'"></gv-ex-time-role-set-create-ctrl>

        <gv-control-messages class="d-flex ml-2" [control]="formGroup?.get('_72_outgoing')"></gv-control-messages>
      </div>

    </div>


    <!-- Ongoing throughout -->
    <div class="border-bottom" *ngIf="(mode$ | async) === 'advanced'">

      <button class="btn btn-link" type="button" *ngIf="!((_roleSet_list$ | async)?._71_outgoing)" (click)="addRoleSet(71)">+ Ongoing throughout</button>

      <div class="modal-body" *ngIf="((_roleSet_list$ | async)?._71_outgoing) && formGroup.get('_71_outgoing')">

        <ng-container *ngTemplateOutlet="header; context:{key:'_71_outgoing', label: 'Ongoing throughout'}"></ng-container>

        <gv-ex-time-role-set-create-ctrl [parentPath]="basePath" [parentTeEntStatePath]="parentTeEntPath" formControlName="_71_outgoing"
          [index]="'_71_outgoing'"></gv-ex-time-role-set-create-ctrl>

        <gv-control-messages class="d-flex ml-2" [control]="formGroup?.get('_71_outgoing')"></gv-control-messages>

      </div>
    </div>


    <!-- Begin of Begin -->
    <div class="border-bottom" *ngIf="(mode$ | async) === 'advanced'">


      <button class="btn btn-link" type="button" *ngIf="!((_roleSet_list$ | async)?._152_outgoing)" (click)="addRoleSet(152)">+ Earliest possible begin</button>

      <div class="modal-body" *ngIf="((_roleSet_list$ | async)?._152_outgoing) && formGroup.get('_152_outgoing')">

        <ng-container *ngTemplateOutlet="header; context:{key:'_152_outgoing', label: 'Earliest possible begin'}"></ng-container>

        <gv-ex-time-role-set-create-ctrl [parentPath]="basePath" [parentTeEntStatePath]="parentTeEntPath" formControlName="_152_outgoing"
          [index]="'_152_outgoing'"></gv-ex-time-role-set-create-ctrl>

        <gv-control-messages class="d-flex ml-2" [control]="formGroup?.get('_152_outgoing')"></gv-control-messages>

      </div>

    </div>

    <!-- End of begin -->
    <div class="border-bottom" *ngIf="(mode$ | async) !== 'one-date'">

      <button class="btn btn-link" type="button" *ngIf="!((_roleSet_list$ | async)?._150_outgoing)" (click)="addRoleSet(150)">+ Begin</button>

      <div class="modal-body" *ngIf="((_roleSet_list$ | async)?._150_outgoing) && formGroup.get('_150_outgoing')">

        <ng-container *ngTemplateOutlet="header; context:{key:'_150_outgoing', label: 'Begin'}"></ng-container>

        <gv-ex-time-role-set-create-ctrl [parentPath]="basePath" [parentTeEntStatePath]="parentTeEntPath" formControlName="_150_outgoing"
          [index]="'_150_outgoing'"></gv-ex-time-role-set-create-ctrl>

        <gv-control-messages class="d-flex ml-2" [control]="formGroup?.get('_150_outgoing')"></gv-control-messages>

      </div>

    </div>


    <!-- Begin of end -->
    <div class="border-bottom" *ngIf="(mode$ | async) !== 'one-date'">

      <button class="btn btn-link" type="button" *ngIf="!((_roleSet_list$ | async)?._151_outgoing)" (click)="addRoleSet(151)">+ End</button>

      <div class="modal-body" *ngIf="((_roleSet_list$ | async)?._151_outgoing) && formGroup.get('_151_outgoing')">

        <ng-container *ngTemplateOutlet="header; context:{key:'_151_outgoing', label: 'End'}"></ng-container>

        <gv-ex-time-role-set-create-ctrl [parentPath]="basePath" [parentTeEntStatePath]="parentTeEntPath" formControlName="_151_outgoing"
          [index]="'_151_outgoing'"></gv-ex-time-role-set-create-ctrl>

        <gv-control-messages class="d-flex ml-2" [control]="formGroup?.get('_151_outgoing')"></gv-control-messages>

      </div>

    </div>

    <!-- End of End -->
    <div class="border-bottom" *ngIf="(mode$ | async) === 'advanced'">

      <button class="btn btn-link" type="button" *ngIf="!((_roleSet_list$ | async)?._153_outgoing)" (click)="addRoleSet(153)">+ Latest possible end</button>

      <div class="modal-body" *ngIf="((_roleSet_list$ | async)?._153_outgoing) && formGroup.get('_153_outgoing')">

        <ng-container *ngTemplateOutlet="header; context:{key:'_153_outgoing', label: 'Latest possible end'}"></ng-container>

        <gv-ex-time-role-set-create-ctrl [parentPath]="basePath" [parentTeEntStatePath]="parentTeEntPath" formControlName="_153_outgoing"
          [index]="'_153_outgoing'"></gv-ex-time-role-set-create-ctrl>

        <gv-control-messages class="d-flex ml-2" [control]="formGroup?.get('_153_outgoing')"></gv-control-messages>

      </div>

    </div>



  </form>

  <div class="modal-footer border-top-0">
    <button type="submit" class="btn btn-primary" [disabled]="(formGroup.invalid || formGroup.pristine) && submitClicked" (click)="onSubmitExistenceTime()">Save</button>
    <button class="btn btn-link" (click)="stopEditing.emit()">Cancel</button>
  </div>
</div>


<!-- ************************** NG TEMPLATES ****************************** -->

<ng-template #header let-key="key" let-label="label">

  <div class="d-flex ">
    <div class="gv-flex-grow-1 gv-card-spacer-x">{{label}}</div>
    <div class="gv-flex-grow-1 gv-card-spacer-x align-self-stretch d-flex" *ngIf="(ontoInfoVisible$|async)">
      <div class="align-self-center">
        <a class="badge badge-success" href="http://ontologies.dataforhistory.org/class/{{(property$|async).dfh_pk_property}}" target="_blank">
          {{(property$|async).dfh_identifier_in_namespace}}
        </a>
      </div>
    </div>

    <button type="button" class="btn btn-sm btn-link align-self-center" (click)="removeRoleSet(key)" title="Remove">
      <i class="fa fa-close"></i>
    </button>
  </div>

</ng-template>
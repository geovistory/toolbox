<div [ngClass]="{'dev-view': entityEditor.devView}">
  <span *ngIf="entityEditor.devView">
    [state: {{peItEntityState}}]
  </span>

  <!-- View State -->

  <div *ngIf="peItEntityState === 'view' && !loading">

    <h5 class="mt-2 mb-4">
       {{mostPopularAppeString}} {{stdAppeString}} <small class="text-muted">{{dfhClass?.dfh_standard_label}}</small>
    </h5>

    <gv-prop-section-list-of-pe-it
    [propSectionListState]="'view'"
    [parentPeIt]="peIt"
    [roles]="peIt?.pi_roles"
    [outgoingProperties]="outgoingProperties"
    [ingoingProperties]="ingoingProperties"
    (appeChange)="whenAppeChange($event)"
    ></gv-prop-section-list-of-pe-it>

  </div>


  <!-- Create State -->

  <div *ngIf="peItEntityState === 'create'">

    <span *ngIf="entityEditor.devView">
      [ready: {{isReadyToCreate}}]
    </span>

    <gv-prop-section-list-of-pe-it
    [propSectionListState]="'create'"
    [parentPeIt]="peItToCreate"
    [outgoingProperties]="outgoingProperties"
    [ingoingProperties]="ingoingProperties"
    (readyToCreate)="emitReadyToCreate($event)"
    (notReadyToCreate)="emitNotReadyToCreate()"
    ></gv-prop-section-list-of-pe-it>


  </div>

  <!-- Add State -->

  <div *ngIf="peItEntityState === 'add-pe-it' && !loading">

    <h5 class="mt-2 mb-4">
       {{mostPopularAppeString}}
    </h5>

    <gv-prop-section-list-of-pe-it
    [roles]="peIt.pi_roles"
    [propSectionListState]="peItEntityState"
    [parentPeIt]="peIt"
    [outgoingProperties]="outgoingProperties"
    [ingoingProperties]="ingoingProperties"
    (readyToCreate)="emitReadyToCreate($event)"
    (notReadyToCreate)="emitNotReadyToCreate()"
    (readyToAdd)="onRolesReadyToAdd($event)"
    (notReadyToAdd)="onRolesNotReadyToAdd()"
    (appeChange)="whenAppeChange($event)"
    ></gv-prop-section-list-of-pe-it>


  </div>


  <!-- Edit and ViewCommunity States  -->

  <div *ngIf="['edit', 'viewCommunity'].indexOf(peItEntityState) > -1 && !loading">

    <!-- Title / Standard Appellations of PeIt -->

    <div class="gv-edit-panel-header">
      <section class="row">
        <div class="col-md-8">
          <h2>
            {{stdAppeString}} <small class="text-muted">{{dfhClass?.dfh_standard_label}}</small>
          </h2>
        </div>
        <span *ngIf="entityEditor.devView">
          [pk: {{peIt?.pk_entity}}]
        </span>
        <gv-entity-editor-settings class="col-md-4 text-right"></gv-entity-editor-settings>


      </section>
    </div>

    <!-- Tools to edit PeIt  -->

    <div class="d-flex flex-row gv-flex-grow-1 m-3">

      <div class="d-flex gv-flex-grow-1" style="max-width:450px">
        <gv-prop-section-list-of-pe-it
        class="gv-flex-grow-1 d-flex flex-row"
        [roles]="peIt.pi_roles"
        [propSectionListState]="peItEntityState"
        [pkEntity]="pkEntity"
        [parentPeIt]="peIt"
        [outgoingProperties]="outgoingProperties"
        [ingoingProperties]="ingoingProperties"
        (appeChange)="whenAppeChange($event)"
        ></gv-prop-section-list-of-pe-it>
      </div>

      <div class="d-flex gv-flex-grow-1 ml-3">
        <div class="d-flex flex-column gv-flex-grow-1">

          <div class="btn-group d-flex mb-3" role="group" aria-label="Basic example">
            <div class="gv-flex-grow-1 bg-gray-700 text-white rounded-left gv-card-spacer-x align-self-stretch d-flex">
              <div class="align-self-center">
                <i class="fa fa-compass"></i>  Map
              </div>
            </div>
            <button class="btn btn-gray-700"><i class="fa fa-ellipsis-v"></i></button>
          </div>

          <div class="card gv-flex-grow-1 mb-3">
            <div class="card-body">

              <gv-pe-it-date></gv-pe-it-date>

            </div>
          </div>

          <div class="card">
            <div class="card-body">
              Timeline
            </div>
          </div>

          <div class="btn-group d-flex mt-3" role="group" aria-label="Basic example">
            <div class="gv-flex-grow-1 bg-gray-700 text-white rounded-left gv-card-spacer-x align-self-stretch d-flex">
              <div class="align-self-center">
                <i class="fa fa-calendar"></i>  Timeline
              </div>
            </div>
            <button class="btn btn-gray-700"><i class="fa fa-search-minus"></i></button>
            <button class="btn btn-gray-700"><i class="fa fa-search-plus"></i></button>
            <button class="btn btn-gray-700"><i class="fa fa-arrows-alt"></i></button>

            <button class="btn btn-gray-700"><i class="fa fa-step-backward"></i></button>
            <button class="btn btn-gray-700"><i class="fa fa-play"></i></button>
            <button class="btn btn-gray-700"><i class="fa fa-step-forward"></i></button>
          </div>

        </div>
      </div>
    </div>
  </div>
</div>
